<?xml version="1.0" encoding="ISO-8859-1" ?>
<interface id="speclib_add">
    <download>
    </download>

    <!-- View definitions -->
    <view id="query_results" label="query_results">
        <blockRef id="main" type="query_results"/>
    </view>

    <!-- Block definitions -->
    <block id="query_results" type="table">
        <data>
            <source type="file" name="query_results/results.tsv"/>
            <parsers>
                <parser type="genericTabular"/>
            </parsers>

            <row>
            </row>

            <row expander="image">
                <column type="jscolumnspectrumviewer" colspan="5" width="600" height="500">
                    <parameter name="file"      file="f.[_dyn_#filename]"/>
                    <parameter name="scan"      value="[_dyn_#scan]"/>
                    <parameter name="modformat" value="inspect"/>
                    <parameter name="trim"      value="true"/>
                </column>
            </row>

            <row expander="USI Links" expandericontype="text">
                <column label="USI-Spectrum" type="genericurlgenerator" width="3">
                    <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>
                    <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPS:TASK-{task}-f.[_dyn_#filename]:scan:[_dyn_#scan]"/>
                    <parameter name="LABEL" value="Spectrum USI"/>
                </column>
                <column label="USI-Spectrum" type="genericurlgenerator" width="3">
                    <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/spectrum/"/>
                    <parameter name="REQUESTPARAMETER=usi" value="mzspec:GNPS:TASK-{task}-f.[_dyn_#filename]:scan:[_dyn_#scan]"/>
                    <parameter name="REQUESTPARAMETER=mz_min" value="[_dyn_#mz_lower]"/>
                    <parameter name="REQUESTPARAMETER=mz_max" value="[_dyn_#mz_upper]"/>
                    <parameter name="LABEL" value="Spectrum USI - With Range"/>
                </column>
                <column type="genericimagedisplayer" label="Structure">
                    <parameter name="URLBASE" value="https://metabolomics-usi.ucsd.edu/png/"/>
                    <parameter name="REQUESTPARAMETER=usi1" value="mzspec:GNPS:TASK-{task}-f.[_dyn_#filename]:scan:[_dyn_#scan]"/>
                    <parameter name="REQUESTPARAMETER=mz_min" value="[_dyn_#mz_lower]"/>
                    <parameter name="REQUESTPARAMETER=mz_max" value="[_dyn_#mz_upper]"/>
                </column>
            </row>
        </data>

    </block>
</interface>
